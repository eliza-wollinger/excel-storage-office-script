{"version":"0.3.0","body":"function main(workbook: ExcelScript.Workbook) {\n    const sheetRetiradas = workbook.getWorksheet(\"RETIRADAS\");\n    const sheetMonitoramento = workbook.getWorksheet(\"BOTAS\");\n\n    // Intervalo de dados (começando da linha 5)\n    const ultimaLinha = sheetRetiradas.getUsedRange().getRowCount();\n    const dados = sheetRetiradas.getRange(`A5:P${ultimaLinha}`).getValues();\n\n    // Índices das colunas\n    const COL_CODIGO = 2;          // Coluna B - Código\n    const COL_TAMANHO = 6;         // Coluna G - Tamanho\n    const COL_FUNCIONARIO = 7;     // Coluna H - Funcionário\n    const COL_DATA_ENTREGA = 12;   // Coluna M - Data Entrega\n    const COL_DATA_DEVOLUCAO = 13; // Coluna N - Data Devolução\n    const COL_STATUS = 14;         // Coluna O - Status\n\n    const dadosFiltrados: (string | number | boolean)[][] = [];\n\n    // Filtrar apenas Status = \"Entregue\"\n    for (let i = 0; i < dados.length; i++) {\n        const statusCelula = dados[i][COL_STATUS]?.toString().trim().toLowerCase();\n        // console.log(statusCelula)\n        if (statusCelula === \"entregue\") {\n            \n            dadosFiltrados.push([\n                dados[i][COL_FUNCIONARIO],      // Funcionário\n                dados[i][COL_TAMANHO],          // Tamanho\n                dados[i][COL_CODIGO],           // Código\n                dados[i][COL_DATA_ENTREGA],     // Data Entrega\n                dados[i][COL_DATA_DEVOLUCAO],   // Data Devolução\n                \"\",                             // Data Troca (vazio)\n                dados[i][COL_STATUS]            // Status\n            ]);\n        }\n    }\n\n    // Limpar dados anteriores\n    const rangeMonitoramento = sheetMonitoramento.getRange(\"B5:H1000\");\n    rangeMonitoramento.clear();\n\n    // Se houver dados filtrados, inserir na planilha\n    if (dadosFiltrados.length > 0) {\n        const rangeDestino = sheetMonitoramento.getRangeByIndexes(\n            4,  // linha 5 (índice 4)\n            1,  // coluna B (índice 1)\n            dadosFiltrados.length,\n            7   // 7 colunas (B até H)\n        );\n        rangeDestino.setValues(dadosFiltrados);\n        console.log(dadosFiltrados)\n        // Adicionar fórmula na coluna Data Troca\n        for (let i = 0; i < dadosFiltrados.length; i++) {\n            const linhaAtual = 5 + i;\n            const celulaDataTroca = sheetMonitoramento.getRange(`G${linhaAtual}`);\n\n            // Fórmula EDATE (entrega + 6 meses)\n            // celulaDataTroca.setFormula(`=EDATE(E${linhaAtual},6)`);\n            celulaDataTroca.setFormula(`=EDATE(DATE(RIGHT(E${linhaAtual},4), MID(E${linhaAtual},4,2), LEFT(E${linhaAtual},2)), 6)`);\n        }\n\n        // Formatar as colunas de data (E, F, G)\n        const colDataEntregaMonit = sheetMonitoramento.getRangeByIndexes(4, 4, dadosFiltrados.length, 1);\n        colDataEntregaMonit.setNumberFormat(\"dd/mm/yyyy\");\n\n        const colDataDevolucaoMonit = sheetMonitoramento.getRangeByIndexes(4, 5, dadosFiltrados.length, 1);\n        colDataDevolucaoMonit.setNumberFormat(\"dd/mm/yyyy\");\n\n        const colDataTrocaMonit = sheetMonitoramento.getRangeByIndexes(4, 6, dadosFiltrados.length, 1);\n        colDataTrocaMonit.setNumberFormat(\"dd/mm/yyyy\");\n    }\n\n    // Atualizar a data de atualização na célula C2\n    const dataAtual = new Date();\n    const dataFormatada = dataAtual.toLocaleDateString(\"pt-BR\") + \" \" +\n        dataAtual.toLocaleTimeString(\"pt-BR\", { hour: '2-digit', minute: '2-digit' });\n    sheetMonitoramento.getRange(\"C2\").setValue(dataFormatada);\n\n    console.log(`Monitoramento atualizado com ${dadosFiltrados.length} registros.`);\n}","description":"","noCodeMetadata":"","parameterInfo":"{\"version\":1,\"originalParameterOrder\":[],\"parameterSchema\":{\"type\":\"object\",\"default\":{},\"x-ms-visibility\":\"internal\"},\"returnSchema\":{\"type\":\"object\",\"properties\":{}},\"signature\":{\"comment\":\"\",\"parameters\":[{\"name\":\"workbook\",\"comment\":\"\"}]}}","apiInfo":"{\"variant\":\"synchronous\",\"variantVersion\":2}"}